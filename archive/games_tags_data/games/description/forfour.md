# FORFOUR (forfour)

**タグ**: rule-match, on_pressed-turn

## 1. コア・メカニクス

| 項目 | 内容 |
|:---|:---|
| 入力 | 押す（グリッド全体を90度回転） |
| 挙動 | 13x13グリッドに色付き円が飛来。タップで回転させ、同色4個以上を繋げると消滅 |
| 終了条件 | 飛来する円がグリッド外に押し出される |
| スコア | (消えた円の数 - 3)² 点。中央から切り離された円も同時消滅でボーナス |
| 難易度 | 時間経過で円の飛来速度が上昇 |

## 2. オブジェクト仕様

| 名前 | 形状 | 動作 | 衝突時 |
|:---|:---|:---|:---|
| player（中央円） | char("a") 6x6 black | グリッド中央(6,6)に固定。回転の基準点 | - |
| circles（グリッド円） | char("a") 6x6 5色 | グリッド上に配置。タップで90度回転 | 同色4個以上接続: 消滅 |
| flying（飛来円） | char("a") 6x6 5色 | 上下左右いずれかからグリッドに向かって直進 | グリッド内の空マスに到達: 配置 |
| guide line | rect light_color | 飛来円の軌道を示す縦または横のライン | - |

## 3. デザインガイド分析

| 原則 | 評価 |
|:---|:---|
| (1) シンプルさと直感性 | グリッド回転という単一操作。5色の円と接続ルールが視覚的に明確。黒円（ワイルドカード）の存在がルール理解を助ける |
| (2) 視覚的フィードバック | 飛来円の軌道ライン、消滅時のパーティクル、グリッド回転のアニメーション。同色接続が一目で判断できる |
| (3) リスク・リワード | 孤立した円を作ると一度に大量消去可能。回転タイミングのミスは即ゲームオーバー。得点が2乗で計算されるため、大量消去が高報酬 |
| (4) 斬新なメカニクス | グリッド全体の回転でマッチングするパズル。孤立した円も消えるルールが戦略的深さを生む。回転による位置予測が習熟要素 |

## 4. タグ詳細

| タグ | 役割 | 戦略的意義 |
|:---|:---|:---|
| rule-match | 同色の円が4個以上接続すると消滅。中央から切り離された円も消滅 | パズル要素の核心。どの色を繋げるか、どう回転させるかの戦略が重要。孤立円ボーナスで高得点を狙える |
| on_pressed-turn | タップでグリッド全体を90度（時計回り）回転 | 回転により飛来円の受け入れ位置を変え、色の配置をコントロール。回転タイミングと回数が習熟要素 |

## 5. 変奏ヒント

| 手法 | アイデア |
|:---|:---|
| Substitute (代用) | グリッド回転を「列/行のスライド」に変更。テトリス風の操作感に |
| Combine (結合) | 回転方向を選べるように（時計回り/反時計回り）。ボタン長押しで逆回転 |
| Modify (修正) | グリッドサイズを難易度に応じて変化。初期9x9から始まり、徐々に拡大または縮小 |
